{% load static %}
{% now "Y" as current_year %}

{% url 'home' as home_url %}
{% url 'register' as register_url %}
{% url 'profile_edit' as profile_edit_url %}
{% url 'kyc_submit' as kyc_submit_url %}

<footer class="s4l-footer">

  <!-- CTA BAR -->
  <div class="s4l-footer-cta">
    <div class="container d-flex flex-wrap justify-content-between align-items-center py-3">
      <div class="text-white">
        {% if user.is_authenticated %}
          <div class="font-weight-bold" style="font-size:18px;">Keep your account ready for emergencies</div>
          <div style="opacity:0.95;">Complete profile & KYC for faster matching.</div>
        {% else %}
          <div class="font-weight-bold" style="font-size:18px;">Join the Lifesavers Community</div>
          <div style="opacity:0.95;">Register today to become a donor and save lives in your area.</div>
        {% endif %}
      </div>

      <div class="mt-3 mt-md-0">
        {% if user.is_authenticated %}
          {% if not user.is_verified and kyc_submit_url %}
            <a href="{{ kyc_submit_url }}" class="btn btn-light font-weight-bold" style="color: var(--secondary-color);">
              <i class="fa fa-id-card mr-1"></i> Complete KYC
            </a>
          {% elif profile_edit_url %}
            <a href="{{ profile_edit_url }}" class="btn btn-light font-weight-bold" style="color: var(--secondary-color);">
              <i class="fa fa-edit mr-1"></i> Update Profile
            </a>
          {% endif %}
        {% else %}
          {% if register_url %}
            <a href="{{ register_url }}" class="btn btn-light font-weight-bold" style="color: var(--secondary-color);">
              Register as Donor
            </a>
          {% endif %}
        {% endif %}
      </div>
    </div>
  </div>

  <!-- MAIN FOOTER -->
  <div class="s4l-footer-main">
    <div class="container py-4">
      <div class="row">

        <!-- BRAND -->
        <div class="col-lg-4 col-md-6 mb-4">
          <a href="{{ home_url|default:'/' }}" class="d-inline-flex align-items-center mb-2" style="text-decoration:none;">
            {% if site_settings and site_settings.site_logo %}
              {# IMPORTANT: logo contains name -> do NOT print site_name again #}
              <img src="{{ site_settings.site_logo.url }}"
                   alt="{{ site_settings.site_name|default:'Share4Life' }}"
                   style="height:64px; width:auto;">
            {% else %}
              <div class="text-white" style="font-weight:900; font-size:22px;">
                <i class="fa fa-heartbeat text-danger mr-2"></i>Share<span class="text-danger">4</span>Life
              </div>
            {% endif %}
          </a>

          <p class="mb-3" style="opacity:.9;">
            {{ site_settings.footer_text|default:"Saving Lives, One Donation at a Time." }}
          </p>

          <div class="d-flex align-items-center">
            {% if site_settings and site_settings.facebook_url %}
              <a class="s4l-social fb" href="{{ site_settings.facebook_url }}" target="_blank" rel="noopener"><i class="fab fa-facebook-f"></i></a>
            {% endif %}
            {% if site_settings and site_settings.instagram_url %}
              <a class="s4l-social ig" href="{{ site_settings.instagram_url }}" target="_blank" rel="noopener"><i class="fab fa-instagram"></i></a>
            {% endif %}
            {% if site_settings and site_settings.twitter_url %}
              <a class="s4l-social x" href="{{ site_settings.twitter_url }}" target="_blank" rel="noopener">
                <svg class="x-logo-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" fill="white">
                  <path d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/>
                </svg>
              </a>
            {% endif %}
          </div>
        </div>

        <!-- LINKS -->
        <div class="col-lg-2 col-md-6 mb-4">
          <div class="s4l-footer-title">Quick Links</div>
          <ul class="s4l-footer-links">
            <li><a href="{{ home_url|default:'/' }}">Home</a></li>
            <li><a href="#">Find Blood</a></li>
            <li><a href="#">Crowdfunding</a></li>
            <li><a href="#">Hospitals</a></li>
          </ul>
        </div>

        <!-- SUPPORT -->
        <div class="col-lg-2 col-md-6 mb-4">
          <div class="s4l-footer-title">Support</div>
          <ul class="s4l-footer-links">
            <li><a href="#" data-toggle="modal" data-target="#privacyModal">Privacy</a></li>
            <li><a href="#" data-toggle="modal" data-target="#termsModal">Terms</a></li>
            <li><a href="#">Contact</a></li>
          </ul>
        </div>

        <!-- CONTACT -->
        <div class="col-lg-4 col-md-6 mb-4">
          <div class="s4l-footer-title">Contact</div>
          <div class="mb-2"><i class="fas fa-phone mr-2"></i>{{ site_settings.contact_phone|default:"+977-9800000000" }}</div>
          <div class="mb-2"><i class="fas fa-envelope mr-2"></i>{{ site_settings.contact_email|default:"support@share4life.com" }}</div>
          <div class="mb-2"><i class="fas fa-map-marker-alt mr-2"></i>{{ site_settings.address|default:"Kathmandu, Nepal" }}</div>
          <div class="mt-3" style="opacity:.85;"><i class="fa fa-lock mr-2"></i>Medical data is protected.</div>
        </div>

      </div>
    </div>
  </div>

  <!-- BOTTOM -->
  <div class="s4l-footer-bottom">
    <div class="container py-3 d-flex flex-wrap justify-content-between align-items-center">
      <div>&copy; {{ current_year }} {{ site_settings.site_name|default:"Share4Life" }}. All rights reserved.</div>
      <div>
        <a href="#" data-toggle="modal" data-target="#privacyModal">Privacy</a>
        <a href="#" data-toggle="modal" data-target="#termsModal" class="ml-3">Terms</a>
      </div>
    </div>
  </div>

</footer>

<!-- Privacy Modal -->
<div class="modal fade" id="privacyModal" tabindex="-1">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header bg-danger text-white">
        <h5 class="modal-title">Privacy Policy</h5>
        <button type="button" class="close text-white" data-dismiss="modal">&times;</button>
      </div>
      <div class="modal-body">
        <h6>Data Protection</h6>
        <p>Your data is protected and shared only with authorized users/hospitals as needed for matching and verification.</p>
      </div>
    </div>
  </div>
</div>

<!-- Terms Modal -->
<div class="modal fade" id="termsModal" tabindex="-1">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header bg-danger text-white">
        <h5 class="modal-title">Terms of Service</h5>
        <button type="button" class="close text-white" data-dismiss="modal">&times;</button>
      </div>
      <div class="modal-body">
        <h6>User Responsibilities</h6>
        <p>By using Share4Life, you agree to provide accurate information and use the platform for legitimate needs.</p>
      </div>
    </div>
  </div>
</div>

<style>
  .s4l-footer { margin-top: 50px; }
  .s4l-footer-cta { background: var(--secondary-color); }
  .s4l-footer-main { background: #455c88; color: rgba(255,255,255,0.88); }
  .s4l-footer-bottom { background: #071b3f; color: rgba(255,255,255,0.75); }

  .s4l-footer-title { color:#fff; font-weight:800; margin-bottom: 12px; }

  .s4l-footer-links { list-style:none; padding:0; margin:0; }
  .s4l-footer-links li { margin-bottom: 8px; }
  .s4l-footer-links a { color: rgba(255,255,255,0.82); text-decoration:none; }
  .s4l-footer-links a:hover { color:#fff; text-decoration: underline; }

  .s4l-footer-bottom a { color: rgba(255,255,255,0.75); text-decoration:none; }
  .s4l-footer-bottom a:hover { color:#fff; text-decoration: underline; }

  .s4l-social{
    width:34px; height:34px; border-radius:8px;
    display:inline-flex; align-items:center; justify-content:center;
    margin-right:8px; color:#fff; text-decoration:none;
  }
  .s4l-social.fb{ background:#1877f2; }
  .s4l-social.ig{ background:#e4405f; }
  .s4l-social.x{ background:#000; }
  .x-logo-svg{ width:18px; height:18px; display:block; }
</style>