{% extends "master/base.html" %}
{% block content %}
<section class="section-content padding-y" style="min-height:84vh;">
  <div class="container" style="max-width: 980px;">
    <div class="d-flex justify-content-between align-items-center mb-3">
      <div>
        <h3 class="mb-1">Chats</h3>
        <div class="text-muted">Chats open only after donor accepts a request.</div>
      </div>
      <a href="{% url 'inbox' %}" class="btn btn-outline-secondary">
        <i class="fa fa-arrow-left"></i> Notifications
      </a>
    </div>

    <div class="card shadow-sm">
      <div class="card-body">
        {% for t in items %}
          <div class="border rounded p-3 mb-2">
            <div class="d-flex justify-content-between">
              <div>
                <div class="font-weight-bold">
                  Request #{{ t.request_id }} — {{ t.request.blood_group }} — {{ t.request.location_city|title }}
                </div>
                <div class="text-muted small">
                  Donor: {{ t.donor.get_full_name|default:t.donor.username }}
                  • Requester: {{ t.requester.get_full_name|default:t.requester.username }}
                </div>
              </div>
              <a class="btn btn-sm btn-primary" href="{% url 'chat_thread_detail' t.id %}">Open</a>
            </div>
          </div>
        {% empty %}
          <div class="text-muted">No chats yet.</div>
        {% endfor %}
      </div>
    </div>
  </div>
</section>
{% endblock %}